<!DOCTYPE html>
<html>

  
  <head>
    
        
        <title>Gulp Jekyll Workflow - Part 1 Design Pattern</title>
    
        
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    
        
        <meta name="HandheldFriendly" content="True" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        
        
    
        
        <link rel="shortcut icon" href="" >
    
        
        <meta name="description" content="Part 1 - Gulp design pattern for working with Jekyll website generator" />
    
        
        
            <link rel="author" href="https://plus.google.com/+https://plus.google.com/&#43;IanTeda" />
        
    
        <link rel="canonical" href="https://ianteda.com/v2/programming/gulp-jekyll-workflow-1/" />
    
        
        <link rel="stylesheet" href='materialize.min-e6e65050.css' type="text/css" property="stylesheet" />
    
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        
        
    
        
        
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
    
        
    </head>

  <body>
    
     


  <header 
  id="single-header"
  class="blue z-depth-1 single-header"
  style="background-image: url(images/cover-code-gulp@desktop-5a9d0799.jpg)">
  
  <nav class="transparent z-depth-0">
  <div class="nav-wrapper">
    <a href="/" class="left brand-logo">Ian Teda</a>
    <a href="#" data-activates="navside" class="button-collapse show-on-large right">
      <i class="material-icons">menu</i>
    </a>
  </div>
</nav>

<ul id="navside" class="side-nav">
    <li class=" blue accent-1">
        <div class="user-view center-align">
            <a href="/">
                <img 
                    class="circle z-depth-2"
                    width="100%" 
                    sizes="(min-width: 36em) 576w, 768w, 992w, 1200w" 
                    srcset="
                        images/head-shot@mobile-3709bafa.jpg 576w,
                        images/head-shot@tablet-b2b2c8f9.jpg 768w,
                        images/head-shot@desktop-be28c554.jpg 992w,
                        images/head-shot@highres-32ef8fb5.jpg 1200w"
                    alt="Ian Teda head shot">
            </a>
            <a href="now.html"><span class="white-text name">Ian Teda</span></a>
            <a href="ian@teda.id.au"><span class="white-text email">ian@teda.id.au</span></a>
        </div>
    </li>
    <li><a href="/blog" class="subheader">Blog</a></li>

    
        <li><a href="creativity">Creativity</a></li>
    
        <li><a href="engineering">Engineering</a></li>
    
        <li><a href="leadership">Leadership</a></li>
    
        <li><a href="programming">Programming</a></li>
    
    <li>
        <div class="divider"></div>
    </li>
    <li><a class="subheader">Pages</a></li>
    <li><a href="now.html">Now</a></li>
    <li><a href="/engineering-rule-book/">Engineering Rule Book</a></li>
</ul>

  
  <div class="valign-wrapper">
    <div class="container">
      <div class="row">
    
        <h1 class="header center white-text"><strong> Gulp Jekyll Workflow - Part 1 Design Pattern </strong></h1>
    
      </div>
    </div>
  </div>
</header>
  
  <div class="container single">
    <div class="row">
      <div class="col text-justify">

        <h2>Gulp Jekyll Workflow - Part 1 Design Pattern</h2>
        
        <nav class="grey lighten-4 z-depth-0">
    <div class="nav-wrapper">
        <div class="col s12">
            
            
            <a class="breadcrumb flow-text" href="/">
                <i class="material-icons flow-text">home</i>
            </a>
            
                
                
            
                
                
                    <a class="breadcrumb flow-text" href='https://ianteda.com/v2programming'>programming</a>
                    
                
            
                
                
                    <a class="breadcrumb flow-text" href='https://ianteda.com/v2programming/gulp-jekyll-workflow-1'>gulp-jekyll-workflow-1</a>
                    
                
            
                
                
            
        </div>
    </div>
</nav>


        
        <div class="s12 flow-text text-justify">
          

<blockquote>
<p>Always start with the end in mind. So you know what direction to travel<br/>
<cite> — Ian Teda </cite></p>
</blockquote>

<p>Keeping the end in mind, I listed four design criteria (patterns) to target when writting Gulp tasks. I wanted my workflow to be modern, simple, configurable and modulised.</p>

<p><strong>Design Criteria/Patterns</strong></p>

<ol>
<li>Use ES2015, ECMAScript 2015 (modern): Why? Get accustom to new JavaScript features before they become mainstream.</li>
<li>Command Line Interface (simple): Why? KISS. Keep It Simple Stupid. A good design is a simple yet functional design.</li>
<li>Configuration File (configurable): Why? Make changes in one place, watch them permiate. Easier to read and maintain code.</li>
<li>Modulised Gulp tasks: Why? Makes for more readable, easier to reuse and maintainable code.</li>
</ol>

<h2 id="1-use-es2015-http-www-ecma-international-org-ecma-262-6-0-with-gulp-http-gulpjs-com">1 - Use <a href="http://www.ecma-international.org/ecma-262/6.0/">ES2015</a> with <a href="http://gulpjs.com/">Gulp</a></h2>

<p>To paraphrase the Babel tagline. Use next generation JavaScript, today with <a href="https://babeljs.io/">Babel</a>. Since the release of Gulp (gulp-cli) version +3.9 <code>gulp -v</code> it is as easy as 1-2-3 to use ES2015 while writting Gulp tasks <sup class="footnote-ref" id="fnref:using-es6-with-gulp"><a rel="footnote" href="#fn:using-es6-with-gulp">1</a></sup>.</p>

<p>To get babel plugged into Gulp I used the following 3 steps:</p>

<p>1 - Install npm packages for Babel and babel presents</p>

<pre><code class="language-javascript">npm install babel-core babel-preset-es2015 --save-dev
</code></pre>

<p>2 - Create a <code>.babelrc</code> file to enable 2015 presets</p>

<pre><code class="language-javascript">{
  &quot;presets&quot;: [&quot;es2015&quot;]
}
</code></pre>

<p>3 - Rename <code>gulpfile.js</code> to <code>gulpfile.babel.js</code></p>

<p>Done. See, as easy as 1-2-3.</p>

<h2 id="2-command-line-interface-with-yargs-http-yargs-js-org">2 - Command Line Interface with <a href="http://yargs.js.org/">Yargs</a></h2>

<p>Paraphrasing the <a href="http://yargs.js.org/">Yargs</a> tagline. Build interactive command line tools by parsing arguments and generating an elegant user interface. Keeping with my design criteria, I refractored the Yargs configuration into a seperate config file <code>yargs.config.js</code>. Which is then required from within the <code>gulpfile.babel.js</code>. Keeping things neat and tidy.</p>

<p>Require Yargs configuration file within <code>gulpfile.babel.js</code>.</p>

<pre><code class="language-javascript">// Command line (CLI) argument
var argv = require(&quot;./gulp/yargs.config&quot;);
</code></pre>

<p>Setup the user interface and configure the CLI arguments <code>yargs.config.js</code> <sup class="footnote-ref" id="fnref:node-command-args"><a rel="footnote" href="#fn:node-command-args">2</a></sup>.</p>

<pre><code class="language-javascript">/**
 * CLI (YARGS) Configuration
 * @param {yargs} yargs - Module for handling CLI arguments
 * @exports {argv} argv - Argument object
 */
module.exports = require(&quot;yargs&quot;)
  .usage(&quot;Usage: Gulp &lt;task&gt; [-p -prod -production]&quot;)
  .command(&quot;script&quot;, &quot;Run script tasks&quot;, {alias: &quot;scripts&quot;})
  .boolean(&quot;production&quot;)
  .alias(&quot;production&quot;, [&quot;p&quot;, &quot;prod&quot;])
  .describe(&quot;production&quot;, &quot;Run Gulp tasks in production mode&quot;)
  .help(&quot;help&quot;)
  .alias(&quot;help&quot;, &quot;?&quot;)
  .argv;
</code></pre>

<h2 id="3-gulp-configuration-file">3 - Gulp Configuration File</h2>

<p>Make changes in one place, watch them permiate. Which equals easier to read and maintain code.</p>

<p><code>gulp.babel.js</code></p>

<pre><code class="language-javascript">// Configuration file for gulp tasks
const config = require(&quot;./gulp/gulp.config&quot;);
</code></pre>

<p><code>gulp.config.js</code></p>

<pre><code class="language-javascript">module.exports = {
  xyz: {
    src: &quot;src/xyz.xyz&quot;,
    options: {
      a: true,
      b: false 
    },
    dest: &quot;src/&quot;
  }
}
</code></pre>

<h2 id="4-modulise-gulp-tasks">4 - Modulise Gulp Tasks</h2>

<p>Modulisation of Gulp tasks makes for more readable, easier to reuse and maintain code.</p>

<p>Always abstract anything you need to do more than once. With that in mind a requireTask function is used to require task files from within <code>gulp.babel.js</code>. <sup class="footnote-ref" id="fnref:module-gulp-tasks"><a rel="footnote" href="#fn:module-gulp-tasks">3</a></sup></p>

<pre><code class="language-javascript">// Import Gulp module
import gulp from &quot;gulp&quot;;
// Command line (CLI) argument
var argv = require(&quot;./gulp/yargs.config&quot;);
// Configuration file for gulp tasks
const config = require(&quot;./gulp/gulp.config&quot;);
// Lazy load plugins, makes for neater source code
var plugins = require(&quot;gulp-load-plugins&quot;)(config.gulpLoadPlugins.options);

/**
 * Require Gulp Task
 * @param {task} task - What Gulp task do you require
 * @return {function} function - Returns task function from module export
 */
function requireTask(task) {
  // Require Gulp task module, passing in Gulp, config, argv and plugin object references
  return require(&quot;./gulp/tasks/&quot; + task + &quot;.task.js&quot;)(
    gulp,
    config,
    argv,
    plugins
  );
}

gulp.task(&quot;scripts:build&quot;, requireTask(&quot;nameOfTask&quot;));
</code></pre>

<p>The task <code>./gulp/tasks/nameOfTask.task.js</code> is built up using the <a href="https://nodejs.org/">NodeJS</a> module pattern, returing the task stream. Returning the task stream is important as it allows Gulp to signal async task completion. With task configuration from withing the <code>gulp.config.js</code> file.</p>

<pre><code class="language-javascript">&quot;use strict&quot;;
/**
 * Gulp Task for doing XYZ
 * @param {gulp} gulp - The gulp module passed in
 * @param {config} config - The projects Gulp config file
 * @param {argv} argv - Arguments flagged at the CLI
 * @param {$} $ - Lazy load plugins, save the imports at the start of the file
 * @return {stream} Stream - Task stream to manage XYZ in project
 */
module.exports = (gulp, config, argv, $) =&gt; {
  return function() {
    var stream = gulp
      // XYZ source files
      .src(config.xyz.src)
      // Apply special Gulp source
      .pipe($.if(
        !argv.prod,
        $.specialsource(config.specialsource.options
      )
      // Write stream to destination folder
      .pipe(gulp.dest(config.xyz.dest));
      
    return stream;
  };
};
</code></pre>

<h2 id="5-just-show-me-the-repository-already">5 - Just Show Me the Repository Already</h2>

<p>If you would like to see it in action, check out the repositry for this website at <a href="https://github.com/IanTeda/IanTeda.github.io">https://github.com/IanTeda/IanTeda.github.io</a></p>

<h5 id="footnotes">Footnotes</h5>
<div class="footnotes">

<hr />

<ol>
<li id="fn:using-es6-with-gulp"><a href="https://markgoodyear.com/2015/06/using-es6-with-gulp/">Using ES6 with gulp</a>
 <a class="footnote-return" href="#fnref:using-es6-with-gulp"><sup>[return]</sup></a></li>
<li id="fn:node-command-args"><a href="http://reverentgeek.com/ahoy-parse-ye-node-js-command-args-with-yargs/">Parse ye Node.js command args with yargs!</a>
 <a class="footnote-return" href="#fnref:node-command-args"><sup>[return]</sup></a></li>
<li id="fn:module-gulp-tasks"><a href="http://macr.ae/article/splitting-gulpfile-multiple-files.html">Splitting a gulpfile into multiple files</a>
 <a class="footnote-return" href="#fnref:module-gulp-tasks"><sup>[return]</sup></a></li>
</ol>
</div>

        </div>
        
        <div class="divider"></div>

          <div class="related">
            <h4>Related:</h4>

            
            
              <p class="flow-text text-justify">
                <em>Opps, there does not appear to be any related posts.</em>
              </p>
            

          </div>

      </div>
    </div>      
  </div>



    
    <footer class="page-footer">
        <div class="container">
          <div class="row">
            <div class="col l6 s12">
              <h5 class="white-text">Ian Teda</h5>
              <p class="grey-text text-lighten-4">Husband, Father, Engineer, Explorer & Creator</p>
      
      
            </div>
            <div class="col l3 s12">
              <h5 class="white-text">Blog Categories</h5>
              <ul>
                
                  <li><a class="white-text" href="creativity">Creativity</a></li>
                
                  <li><a class="white-text" href="engineering">Engineering</a></li>
                
                  <li><a class="white-text" href="leadership">Leadership</a></li>
                
                  <li><a class="white-text" href="programming">Programming</a></li>
                
              </ul>
            </div>
            <div class="col l3 s12">
              <h5 class="white-text">Pages</h5>
              <ul>
                <li><a class="white-text" href="now.html">Now</a></li>
                <li><a class="white-text" href="/engineering-rule-book/">Engineering Rule Book</a></li>
              </ul>
            </div>
          </div>
        </div>
      
        <div class="footer-copyright">
            <div class="container">
              <div class="row valign-wrapper">
                <div class="col s6 left">
                  © 2017 Ian Teda
                </div>
                <div class="col s6 right">
                  <a class="grey-text text-lighten-4 right" href="https://github.com/IanTeda" target="_blank"><i class="fa fa-github-square fa-2x" aria-hidden="true"></i>&nbsp;&nbsp;</a>
                  <a class="grey-text text-lighten-4 right" href="https://www.linkedin.com/in/ianteda/" target="_blank"><i class="fa fa-linkedin-square fa-2x" aria-hidden="true"></i>&nbsp;&nbsp;</a>
                  <a class="grey-text text-lighten-4 right" href="https://www.youtube.com/user/IanTeda/" target="_blank"><i class="fa fa-youtube-square fa-2x" aria-hidden="true"></i>&nbsp;&nbsp;</a>
                  <a class="grey-text text-lighten-4 right" href="https://www.instagram.com/ianteda/" target="_blank"><i class="fa fa-instagram fa-2x" aria-hidden="true"></i>&nbsp;&nbsp;</a>
                  <a class="grey-text text-lighten-4 right" href="https://twitter.com/IanTeda" target="_blank"><i class="fa fa-twitter-square fa-2x" aria-hidden="true"></i>&nbsp;&nbsp;</a>
                  <a class="grey-text text-lighten-4 right" href="https://www.facebook.com/ian.teda" target="_blank"><i class="fa fa-facebook-square fa-2x" aria-hidden="true"></i>&nbsp;&nbsp;</a>
                  <a class="grey-text text-lighten-4 right" href="ian@teda.id.au" target="_blank"><i class="fa fa-envelope fa-2x" aria-hidden="true"></i>&nbsp;&nbsp;</a>
                </div>
              </div>
            </div>
          </div>
      </footer>

    
    <script src='materialize.min-054a4c0a.js'></script>

    
    

  </body>

</html>